#include <16f877a.h>
#fuses xt, nowdt
#use delay(clock=4M)

// Pines de conexión
#define LOAD pin_a0
#define DIN pin_c5
#define CLK pin_c3
 
const unsigned char caracteres[22][8] = {
    {0x3E, 0x51, 0x49, 0x45, 0x3E, 0x00, 0x00, 0x00},  
    {0x00, 0x42, 0x7F, 0x40, 0x00, 0x00, 0x00, 0x00},   
    {0x62, 0x51, 0x51, 0x49, 0x46, 0x00, 0x00, 0x00},  
    {0x22, 0x41, 0x49, 0x49, 0x36, 0x00, 0x00, 0x00}, 
    {0x18, 0x14, 0x12, 0x7F, 0x10, 0x00, 0x00, 0x00},   
    {0x27, 0x45, 0x45, 0x45, 0x39, 0x00, 0x00, 0x00},  
    {0x3E, 0x49, 0x49, 0x49, 0x32, 0x00, 0x00, 0x00},   
    {0x03, 0x01, 0x79, 0x05, 0x03, 0x00, 0x00, 0x00},  
    {0x36, 0x49, 0x49, 0x49, 0x36, 0x00, 0x00, 0x00},   
    {0x26, 0x49, 0x49, 0x49, 0x3E, 0x00, 0x00, 0x00},   
    {0x7C, 0x12, 0x11, 0x12, 0x7C, 0x00, 0x00, 0x00},  
    {0x7F, 0x49, 0x49, 0x49, 0x36, 0x00, 0x00, 0x00},   
    {0x3E, 0x41, 0x41, 0x41, 0x22, 0x00, 0x00, 0x00},   
    {0x7F, 0x41, 0x41, 0x22, 0x1C, 0x00, 0x00, 0x00},   
    {0x7F, 0x49, 0x49, 0x49, 0x41, 0x00, 0x00, 0x00},   
    {0x7F, 0x09, 0x09, 0x09, 0x01, 0x00, 0x00, 0x00},   
    {0x3E, 0x41, 0x49, 0x49, 0x7A, 0x00, 0x00, 0x00},   
    {0x7F, 0x08, 0x08, 0x08, 0x7F, 0x00, 0x00, 0x00},   
    {0x41, 0x7F, 0x41, 0x00, 0x00, 0x00, 0x00},  // I
    {0x30, 0x40, 0x40, 0x3F, 0x00, 0x00, 0x00, 0x00},   
    {0x7F, 0x08, 0x14, 0x22, 0x41, 0x00, 0x00, 0x00},   
     
    {0x0C, 0x1E, 0x3F, 0x7E, 0x7E, 0x3F, 0x1E, 0x0C}    
};

 
void mostrar_caracter(unsigned char indice) {
    for (int row = 0; row < 8; row++) {
        output_low(LOAD);
        spi_write(row + 1);
        spi_write(caracteres[indice][row]);
        output_high(LOAD);
    }
}

 
void configuracion() {
   
    setup_spi(SPI_MASTER | SPI_SS_DISABLED | SPI_L_TO_H);
    
     
    output_low(LOAD);
    spi_write(0x09);
    spi_write(0x00);  
    output_high(LOAD);
    
    output_low(LOAD);
    spi_write(0x0A);
    spi_write(0x08); 
    output_high(LOAD);
    
    output_low(LOAD);
    spi_write(0x0B);
    spi_write(0x07);  
    output_high(LOAD);
    
    output_low(LOAD);
    spi_write(0x0C);
    spi_write(0x01);  
    output_high(LOAD);
    
    output_low(LOAD);
    spi_write(0x0F);
    spi_write(0x00);  
    output_high(LOAD);
}

 
void main() {
     
    configuracion();
    
     
    unsigned char indice = 0;
    while (true) {
        
        mostrar_caracter(indice);
        
        
        delay_ms(1000);
        
        
        indice = (indice + 1) % 22; 
    }
}

